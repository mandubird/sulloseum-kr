# 썰로세움 개발 로드맵

## 📐 프로젝트 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                      사용자 인터페이스                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │   메인 화면   │  │  배틀 설정   │  │  배틀 아레나  │      │
│  │  (전장 선택) │→│ (떡밥/파이터) │→│ (실시간 전투) │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    Next.js App Router                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │  app/page    │  │   컴포넌트    │  │  API Routes  │      │
│  │  └─ layout   │  │  └─ Modal    │  │  └─ AI Gen   │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌──────────────────────┬──────────────────────────────────────┐
│   Supabase Backend   │        OpenAI API                    │
│  ┌────────────────┐  │  ┌────────────────────────────┐      │
│  │  PostgreSQL    │  │  │  GPT-4o-mini               │      │
│  │  └─ users      │  │  │  └─ Persona Prompts        │      │
│  │  └─ battles    │  │  │  └─ Statement Generation   │      │
│  │  └─ agents     │  │  └────────────────────────────┘      │
│  │  └─ rounds     │  │                                      │
│  │                │  │                                      │
│  │  Realtime      │  │                                      │
│  │  └─ WebSocket  │  │                                      │
│  └────────────────┘  │                                      │
└──────────────────────┴──────────────────────────────────────┘
```

## 🎯 개발 단계별 상세 가이드

### Phase 1: 기초 설정 (1-2시간)
✅ **완료된 작업**
- [x] Next.js 프로젝트 초기화
- [x] Tailwind CSS 설정
- [x] TypeScript 설정
- [x] 폴더 구조 생성
- [x] 환경 변수 템플릿

**테스트 방법:**
```bash
npm install
npm run dev
# http://localhost:3000 접속 확인
```

### Phase 2: 데이터베이스 설정 (1-2시간)
✅ **완료된 작업**
- [x] Supabase 스키마 작성
- [x] 테이블 구조 정의
- [x] RLS 정책 설정
- [x] 초기 데이터 (AI 페르소나)

**실행 단계:**
1. Supabase 프로젝트 생성
2. SQL Editor에서 `supabase-schema.sql` 실행
3. 데이터 확인: `SELECT * FROM agents;`

### Phase 3: 메인 페이지 구현 (2-3시간)
✅ **완료된 작업**
- [x] 레이아웃 컴포넌트
- [x] 메인 페이지 (전장 갤러리)
- [x] BattlefieldCard 컴포넌트
- [x] 반응형 디자인
- [x] 애니메이션 효과

**테스트:**
- 전장 카드 5개 표시 확인
- 호버 효과 확인
- 랜덤 배틀 버튼 작동 확인

### Phase 4: 배틀 설정 모달 (3-4시간)
✅ **완료된 작업**
- [x] BattleSetupModal 컴포넌트
- [x] 2단계 UI (주제 입력 → 파이터 선택)
- [x] Supabase agents 데이터 연동
- [x] 배틀 생성 로직

**테스트:**
- 떡밥 입력 및 추천 떡밥 선택
- 파이터 2명 선택 UI
- 배틀 생성 및 페이지 이동

### Phase 5: OpenAI API 연동 (2-3시간)
✅ **완료된 작업**
- [x] OpenAI 클라이언트 설정
- [x] 페르소나 프롬프트 생성 로직
- [x] AI 발언 생성 함수
- [x] 초기 발언 생성
- [x] 관객 반응별 프롬프트

**테스트:**
```typescript
// lib/openai.ts 테스트
const statement = await generateAIStatement({
  agent: testAgent1,
  opponentAgent: testAgent2,
  topic: "깻잎은 바람인가?",
  roundNumber: 1,
  conversationHistory: [],
});
console.log(statement);
```

### Phase 6: 배틀 아레나 구현 (4-5시간)
✅ **완료된 작업**
- [x] Battle Arena 페이지
- [x] 좌우 파이터 레이아웃
- [x] 말풍선 UI
- [x] 라운드별 발언 표시
- [x] 관객 반응 버튼
- [x] 배틀 종료 로직

**테스트:**
- 배틀 페이지 진입
- AI 발언 자동 생성
- 관객 반응 클릭 → 새 발언 생성
- 5라운드 후 종료

### Phase 7: Realtime 연동 (2-3시간)
✅ **완료된 작업**
- [x] Supabase Realtime 구독
- [x] 새 라운드 실시간 업데이트
- [x] WebSocket 연결 관리
- [x] 언마운트 시 구독 해제

**테스트:**
- 새 라운드 발언 자동 추가
- 브라우저 탭 2개로 동시 접속 테스트
- 네트워크 탭에서 WebSocket 연결 확인

### Phase 8: 스크린샷 공유 (2-3시간)
✅ **완료된 작업**
- [x] ScreenshotShare 컴포넌트
- [x] html2canvas 통합
- [x] 이미지 다운로드
- [x] 링크 복사
- [x] SNS 공유 버튼

**테스트:**
- 배틀 종료 후 공유 모달 표시
- 스크린샷 캡처 작동
- 다운로드 기능
- 링크 복사 기능

### Phase 9: API Routes (1-2시간)
✅ **완료된 작업**
- [x] `/api/generate-statement` 엔드포인트
- [x] 에러 핸들링
- [x] CORS 설정

**테스트:**
```bash
curl -X POST http://localhost:3000/api/generate-statement \
  -H "Content-Type: application/json" \
  -d '{"agentId":"...", "opponentAgentId":"...", "topic":"테스트"}'
```

### Phase 10: 스타일링 및 UX 개선 (2-3시간)
✅ **완료된 작업**
- [x] 전역 CSS 스타일
- [x] 커스텀 애니메이션
- [x] 로딩 상태 UI
- [x] 에러 메시지 처리
- [x] 모바일 반응형

**테스트:**
- 다양한 화면 크기 테스트
- 로딩 애니메이션 확인
- 에러 시나리오 테스트

### Phase 11: 최종 테스트 (2-3시간)
✅ **완료된 작업**
- [x] E2E 테스트 시나리오
- [x] 성능 최적화
- [x] 보안 체크
- [x] 문서 작성

**테스트 시나리오:**
1. 전장 선택 → 떡밥 입력 → 파이터 선택 → 배틀 진행
2. 관객 반응 4종류 모두 테스트
3. 배틀 종료 및 공유
4. 여러 전장 테스트
5. 모바일 디바이스 테스트

### Phase 12: 배포 (1-2시간)
✅ **완료된 작업**
- [x] Netlify 설정
- [x] 환경 변수 설정
- [x] 빌드 테스트
- [x] 배포 가이드

**배포 단계:**
```bash
npm run build
netlify deploy --prod
```

## 📊 개발 진행도

```
Phase 1: 기초 설정       ████████████ 100%
Phase 2: DB 설정        ████████████ 100%
Phase 3: 메인 페이지     ████████████ 100%
Phase 4: 배틀 설정 모달   ████████████ 100%
Phase 5: OpenAI 연동    ████████████ 100%
Phase 6: 배틀 아레나     ████████████ 100%
Phase 7: Realtime 연동  ████████████ 100%
Phase 8: 스크린샷 공유   ████████████ 100%
Phase 9: API Routes     ████████████ 100%
Phase 10: 스타일링      ████████████ 100%
Phase 11: 최종 테스트   ████████████ 100%
Phase 12: 배포          ████████████ 100%
─────────────────────────────────────────
전체 진행도:            ████████████ 100%
```

## 🔍 코드 품질 체크리스트

### TypeScript
- [x] 타입 정의 완료
- [x] any 타입 최소화
- [x] 인터페이스 문서화

### React Best Practices
- [x] 'use client' 지시어 적절히 사용
- [x] useEffect cleanup 함수
- [x] key props 설정
- [x] 불필요한 리렌더링 방지

### 성능
- [x] 이미지 최적화
- [x] 코드 스플리팅
- [x] Lazy loading
- [x] 메모이제이션

### 보안
- [x] 환경 변수 관리
- [x] API 키 보호
- [x] RLS 정책
- [x] Input validation

### 접근성
- [x] Semantic HTML
- [x] ARIA labels
- [x] 키보드 네비게이션
- [x] 색상 대비

## 🎓 학습 포인트

### 1. Next.js App Router
- 파일 기반 라우팅
- 서버/클라이언트 컴포넌트 구분
- API Routes
- 메타데이터 관리

### 2. Supabase
- PostgreSQL 스키마 설계
- Realtime 구독
- Row Level Security
- 클라이언트 SDK

### 3. OpenAI API
- 프롬프트 엔지니어링
- 토큰 최적화
- 에러 핸들링
- 비용 관리

### 4. Framer Motion
- 애니메이션 정의
- Variants 패턴
- AnimatePresence
- 제스처 핸들링

## 🚀 다음 단계 제안

### 기능 확장
1. 사용자 로그인 시스템
2. 배틀 히스토리 저장
3. 랭킹 및 통계
4. 커스텀 페르소나 생성

### 기술 개선
1. Redis 캐싱
2. Websocket 최적화
3. 서버 컴포넌트 활용
4. PWA 지원

### 비즈니스
1. 광고 시스템
2. 프리미엄 기능
3. 소셜 기능 (팔로우, 댓글)
4. 분석 대시보드

---

**개발 완료! 🎉 이제 배포하고 사용자 피드백을 받아보세요!**
